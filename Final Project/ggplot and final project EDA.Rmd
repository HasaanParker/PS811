---
title: 'Assignment from Nov 19'
author: "Hasaan Parker"
date: "11/19/2020"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
theme_set(theme_bw())
```

Create the following graphs in `ggplot2`.

1. Check out the base R built-in dataset, `data("USArrests")`.
```{r}
data("USArrests")
summary(USArrests)
```


2. Create a scatterplot that looks at the correlation between murder and assault arrests. Label the x and y axes and title the graph.
```{r}
USArrests %>% ggplot(aes(Murder, Assault)) +
  geom_point() +
  labs(title = "Relationship between Murder and Assault in the United States",
       x = "Murders", y = "Assaults") 
  
```

3. Create a boxplot of rape arrests. Label the plot.
```{r}
USArrests %>% ggplot(aes(y = Rape )) + 
  geom_boxplot(width = .1) + 
  labs(title = "Box Plot of Rape Arrests in the USA",
       x = "Rape", y = "Arrests") + 
  theme(axis.ticks.x = element_blank(),
        axis.text.x = element_blank())
```


4. Create a barplot of the number of rape arrests per state.
```{r}
USArrests %>% 
  arrange(desc(Rape)) %>% 
  rownames_to_column("State") %>% 
  ggplot(aes(reorder(State, -Rape), Rape)) + 
  geom_col(color = "white") + 
  scale_y_continuous(expand = c(0,0)) + 
  labs(title = "Rape Arrests by State per 100,000 residents",
       subtitle = "USA, 1973 ",
        x = "State", y = "Rape Arrests") +
  theme(axis.text.x = element_text(angle=90),
        axis.ticks.x = element_blank()) 

```

5. Create a histogram for the percent of urban population.
```{r}
USArrests %>% 
  ggplot(aes(UrbanPop)) +
  geom_histogram(color = "white", fill = "#BB0000", bins = 15) +
  geom_hline(yintercept = 0) +
  labs(title = "Histogram of Urban Population across US States",
       subtitle = "Data: 1973",
       x = "Percentage of state population living in Urban Area",
       y = "# of States"
       )
```

# Your project

Now it's your turn. Use the `ggplot2` tools you used today to conduct data analysis for one of your final seminar papers.

1. Create a Git repository for your project.

2. Upload the dataset you are planning to use. If are you planning to collect original data, please provide all the variables that will be in that original dataseet.

3. How will these variables help answer your question?
I will be using the CoW Project national trade data to analyze patterns in international trade overtime.

4. Consider the variables. Which variables would you want to highlight? How would you visually represent them? Plan to create at least three descriptive graphs. Some suggestions:

    + If you have time-related variable, create a line graph showing changes over time!
    
    + If your observations can be separated by certain groups, create bar graphs or facets~
I plan to create a line graph of international export flow over for the US, China, and Brazil.
Then, I will create a bar graph of the import/export balance for the largest 25 countries in the most recent year of the dataset (2014).
Lastly, I will make a graph comparing the import/export balance to total trade volume, to understand if there is a relationship between the size of an economy and whether it imports or exports more goods/services.

5. Given what you brainstormed in Question 4, create plots using the `ggplot2` package. Label all axes and title each graph. Provide descriptions for each graph.
```{r}
trade <- read_csv("/Users/hasaanparker/Documents/School/Fall 21/812 stats intro/Final Project/Data/COW_Trade_4.0/National_COW_4.0.csv")

trade %>% 
  filter(stateabb == c("CHN", "BRA", "USA")) %>%
  ggplot(aes(year, exports))  +
  geom_line(aes(col = stateabb)) + 
  scale_y_log10()

trade <- trade %>% 
  mutate(total = imports + exports, 
         balance = exports / imports) 
trade %>% 
  filter(year == 2014) %>% 
  arrange(desc(total)) %>% 
  slice_head(n = 25) %>% 
  ggplot(aes(reorder(stateabb, balance), balance)) +
  geom_col() + 
  coord_flip()

trade %>% 
  filter(year == 2014) %>% 
  ggplot(aes(balance, total)) +
  geom_point() + 
  geom_smooth(method = "lm") + 
  scale_y_log10()
  
```

# Submit

Email me (laaker@wisc.edu) the link to your github when you are done.